# ===========================================
# Liyaqa Production Environment - DigitalOcean
# ===========================================
# Complete production configuration for DigitalOcean Droplet
#
# INSTRUCTIONS:
# 1. Copy this file: cp .env.production .env
# 2. Replace ALL placeholder values
# 3. Generate secrets with provided commands
# 4. Never commit .env to version control

# ===========================================
# üîê SECURITY - GENERATE THESE FIRST!
# ===========================================
# Generate database password: openssl rand -base64 32
POSTGRES_PASSWORD=

# Generate JWT secret (CRITICAL - min 32 chars): openssl rand -base64 48
JWT_SECRET=

# Generate Redis password: openssl rand -base64 24
REDIS_PASSWORD=

# ===========================================
# üóÑÔ∏è DATABASE CONFIGURATION
# ===========================================
POSTGRES_DB=liyaqa
POSTGRES_USER=liyaqa
# Password set above in SECURITY section

# Database connection pool (adjust based on droplet size)
# For 4GB RAM droplet: 20
# For 8GB RAM droplet: 30
DB_POOL_SIZE=20
DB_POOL_MIN_IDLE=5

# ===========================================
# üåê DOMAIN & CORS CONFIGURATION
# ===========================================
# Your droplet IP or domain
# EXAMPLE: DOMAIN=liyaqa.example.com
DOMAIN=YOUR_DOMAIN_OR_IP

# After SSL setup, change to https://
# EXAMPLE: https://liyaqa.example.com,https://app.liyaqa.example.com
CORS_ALLOWED_ORIGINS=http://${DOMAIN}

# Base domain for multi-tenant subdomains
# EXAMPLE: liyaqa.example.com
LIYAQA_BASE_DOMAIN=${DOMAIN}

# Frontend API endpoint (browser-accessible)
# After SSL setup, change to https://
NEXT_PUBLIC_API_URL=http://${DOMAIN}/api

# ===========================================
# üìß EMAIL CONFIGURATION (SendGrid Recommended)
# ===========================================
# Choose provider: sendgrid, ses, smtp
EMAIL_PROVIDER=sendgrid
EMAIL_ENABLED=true
EMAIL_FROM=noreply@${DOMAIN}
EMAIL_FROM_NAME=Liyaqa

# SendGrid (Recommended - Free tier: 100 emails/day)
# Signup: https://signup.sendgrid.com/
SENDGRID_API_KEY=

# AWS SES (Alternative - Low cost, requires AWS account)
AWS_SES_REGION=me-south-1
AWS_SES_ACCESS_KEY=
AWS_SES_SECRET_KEY=

# SMTP Fallback (Basic - Use Gmail/Outlook)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_AUTH=true
SMTP_STARTTLS=true

# ===========================================
# üì± SMS CONFIGURATION (Optional)
# ===========================================
SMS_ENABLED=false
SMS_PROVIDER=twilio

# Twilio (https://www.twilio.com/)
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_FROM_NUMBER=

# ===========================================
# üíæ FILE STORAGE (Choose: s3 or minio)
# ===========================================
# For production: Use S3 (scalable, reliable)
# For development/testing: Use MinIO (self-hosted S3-compatible)
STORAGE_TYPE=s3

# AWS S3 Configuration
S3_BUCKET_NAME=liyaqa-files-prod
AWS_REGION=me-south-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# MinIO Configuration (Self-hosted alternative)
MINIO_ENDPOINT=http://minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=
MINIO_BUCKET=liyaqa-files

# ===========================================
# üí≥ PAYMENT GATEWAYS (Saudi Arabia)
# ===========================================
# PayTabs (Primary - Saudi market)
PAYTABS_ENABLED=false
PAYTABS_PROFILE_ID=
PAYTABS_SERVER_KEY=
PAYTABS_CALLBACK_URL=https://${DOMAIN}/api/payments/paytabs/callback
PAYTABS_RETURN_URL=https://${DOMAIN}/payment/complete

# STC Pay (Alternative)
STCPAY_ENABLED=false
STCPAY_MERCHANT_ID=
STCPAY_API_KEY=
STCPAY_CALLBACK_URL=https://${DOMAIN}/api/payments/stcpay/callback

# Tamara (Buy Now Pay Later)
TAMARA_ENABLED=false
TAMARA_API_URL=https://api.tamara.co
TAMARA_API_TOKEN=
TAMARA_NOTIFICATION_TOKEN=

# ===========================================
# üßæ ZATCA E-INVOICING (Saudi Arabia Compliance)
# ===========================================
ZATCA_ENABLED=false
ZATCA_ENVIRONMENT=sandbox
ZATCA_SELLER_NAME=
ZATCA_VAT_NUMBER=
ZATCA_BUILDING_NUMBER=
ZATCA_STREET_NAME=
ZATCA_DISTRICT=
ZATCA_CITY=
ZATCA_POSTAL_CODE=
ZATCA_COUNTRY_CODE=SA

# ===========================================
# üîÑ REDIS CONFIGURATION
# ===========================================
REDIS_HOST=redis
REDIS_PORT=6379
# Password set above in SECURITY section
REDIS_DATABASE=0
REDIS_TIMEOUT=5000

# Session configuration
SPRING_SESSION_STORE_TYPE=redis
SPRING_SESSION_TIMEOUT=1800

# ===========================================
# üìä MONITORING & OBSERVABILITY
# ===========================================
# Prometheus metrics
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,info,metrics,prometheus
MANAGEMENT_METRICS_EXPORT_PROMETHEUS_ENABLED=true

# Distributed tracing
TRACING_ENABLED=true
TRACING_SAMPLE_RATE=0.1
ZIPKIN_ENDPOINT=http://zipkin:9411/api/v2/spans

# Grafana admin credentials
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=

# ===========================================
# üöÄ APPLICATION CONFIGURATION
# ===========================================
SPRING_PROFILES_ACTIVE=prod
ENVIRONMENT=production

# Server configuration
SERVER_PORT=8080
NODE_ENV=production

# JVM Memory settings (adjust based on droplet size)
# For 4GB RAM droplet: -Xms512m -Xmx1024m
# For 8GB RAM droplet: -Xms1g -Xmx2g
JAVA_OPTS=-Xms512m -Xmx1024m -XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0 -XX:+UseG1GC

# Node.js settings
NODE_OPTIONS=--max-old-space-size=512

# ===========================================
# üîí SECURITY HARDENING
# ===========================================
# Enable HSTS after SSL is configured
HSTS_ENABLED=false
HSTS_MAX_AGE=31536000

# Security headers
SECURITY_HEADERS_ENABLED=true

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_SECOND=10

# ===========================================
# üåç LOCALIZATION
# ===========================================
DEFAULT_LOCALE=ar
SUPPORTED_LOCALES=ar,en
DEFAULT_TIMEZONE=Asia/Riyadh

# ===========================================
# üìù LOGGING
# ===========================================
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_COM_LIYAQA=INFO
LOGGING_PATTERN_CONSOLE=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# JSON logging for production (better for log aggregation)
LOGGING_FILE_ENABLED=true
LOGGING_FILE_PATH=/var/log/liyaqa

# ===========================================
# üîß ADVANCED CONFIGURATION (Optional)
# ===========================================
# Database connection timeouts
DB_CONNECTION_TIMEOUT=30000
DB_IDLE_TIMEOUT=600000
DB_MAX_LIFETIME=1800000

# Async thread pool
ASYNC_CORE_POOL_SIZE=10
ASYNC_MAX_POOL_SIZE=40
ASYNC_QUEUE_CAPACITY=500

# Multipart file upload limits
MULTIPART_MAX_FILE_SIZE=10MB
MULTIPART_MAX_REQUEST_SIZE=10MB

# ===========================================
# üîê SECRETS MANAGEMENT (Advanced)
# ===========================================
# For production, consider using:
# - AWS Secrets Manager
# - HashiCorp Vault
# - DigitalOcean App Platform secrets

# AWS Secrets Manager (if using)
AWS_SECRETS_ENABLED=false
AWS_SECRETS_REGION=me-south-1

# ===========================================
# üõ°Ô∏è BACKUP CONFIGURATION
# ===========================================
# Backup schedule (cron format)
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30

# S3 backup destination
BACKUP_S3_BUCKET=liyaqa-backups
BACKUP_S3_PREFIX=prod/

# ===========================================
# üìß NOTIFICATION CHANNELS
# ===========================================
# Slack webhook for critical alerts (optional)
SLACK_WEBHOOK_URL=

# Discord webhook (optional)
DISCORD_WEBHOOK_URL=

# Telegram bot (optional)
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# ===========================================
# üéØ FEATURE FLAGS
# ===========================================
FEATURE_MEMBER_PORTAL_ENABLED=true
FEATURE_MOBILE_APP_API_ENABLED=true
FEATURE_ANALYTICS_ENABLED=true
FEATURE_ADVANCED_REPORTING_ENABLED=true

# ===========================================
# END OF CONFIGURATION
# ===========================================
